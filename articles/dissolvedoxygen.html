<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dissolved Oxygen • pepreporting</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Dissolved Oxygen">
<meta property="og:description" content="pepreporting">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pepreporting</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Introduction.html">Introduction</a>
    </li>
    <li>
      <a href="../articles/dissolvedoxygen.html">Dissolved Oxygen</a>
    </li>
    <li>
      <a href="../articles/pathogens.html">Beach Pathogens</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="dissolvedoxygen_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Dissolved Oxygen</h1>
            
      
      
      <div class="hidden name"><code>dissolvedoxygen.Rmd</code></div>

    </div>

    
    
<p>This document describes a potential proof of concept for summarizing and reporting dissolved oxygen (DO) data for the Peconic Estuary. Two continuous USGS monitoring stations collect DO data at locations in or near the Peconic Estuary. The <code>dodat</code> data object includes sample data from these stations. This dataset was obtained using the USGS dataRetrieval R package as follows:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">dataRetrieval</span><span class="op">)</span>

<span class="co"># get DO data from USGS stations</span>
<span class="co"># 01304562 is Peconic River</span>
<span class="co"># downloaded data are in UTC</span>
<span class="co"># for cd column, USGS daily value qualification codes are often “A” (approved for publication) or “P” (provisional data subject to revision)</span>
<span class="co"># above is from vignette https://cran.r-project.org/web/packages/dataRetrieval/vignettes/dataRetrieval.html</span>
<span class="co"># takes a few minutes to dl</span>
<span class="va">dodat</span> <span class="op">&lt;-</span> <span class="fu">readNWISuv</span><span class="op">(</span>siteNumbers <span class="op">=</span> <span class="st">'01304562'</span>, parameterCd <span class="op">=</span> <span class="st">'00300'</span>, startDate <span class="op">=</span> <span class="st">'2013-01-01'</span>, endDate <span class="op">=</span> <span class="st">'2020-12-31'</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span>site <span class="op">=</span> <span class="va">site_no</span>, DateTime <span class="op">=</span> <span class="va">dateTime</span>, do_mgl <span class="op">=</span> <span class="va">X_00300_00000</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>DateTime <span class="op">=</span> <span class="fu">with_tz</span><span class="op">(</span><span class="va">DateTime</span>, tzone <span class="op">=</span> <span class="st">'America/Jamaica'</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dodat</span><span class="op">)</span>
<span class="co">#&gt;       site            DateTime do_mgl</span>
<span class="co">#&gt; 1 01304200 2013-01-01 00:00:00   11.2</span>
<span class="co">#&gt; 2 01304200 2013-01-01 00:06:00   11.2</span>
<span class="co">#&gt; 3 01304200 2013-01-01 00:12:00   11.2</span>
<span class="co">#&gt; 4 01304200 2013-01-01 00:18:00   11.2</span>
<span class="co">#&gt; 5 01304200 2013-01-01 00:24:00   11.2</span>
<span class="co">#&gt; 6 01304200 2013-01-01 00:30:00   11.2</span></code></pre></div>
<p>A plot of the raw data:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span><span class="va">dodat</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">DateTime</span>, y <span class="op">=</span> <span class="va">do_mgl</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">4.8</span>, linetype <span class="op">=</span> <span class="st">'dashed'</span>, colour <span class="op">=</span> <span class="st">'red'</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">3</span>, linetype <span class="op">=</span> <span class="st">'dashed'</span>, colour <span class="op">=</span> <span class="st">'red'</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>
    y <span class="op">=</span> <span class="st">'Dissolved oxygen (mg/L)'</span>, 
    x <span class="op">=</span> <span class="cn">NULL</span>, 
    title <span class="op">=</span> <span class="st">'Dissolved oxygen time series at USGS station 01304562 (Peconic R.)'</span>, 
    subtitle <span class="op">=</span> <span class="st">'Dashed lines are chronic and acute threhsolds (4.8, 3 mg/L)'</span>
  <span class="op">)</span></code></pre></div>
<p><img src="dissolvedoxygen_files/figure-html/unnamed-chunk-4-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Dissolved oxygen data typically show daily and and seasonal variation. The continuous data requires considerable summary to present the data in an easily interpretable format for management decisions and to present the data in a way that expresses condition. For both, acute (3 mg/L) and chronic (4.8 mg/L) dissolved oxygen thresholds can be applied to summarize the data in different ways.</p>
<p>Further, the impact of low dissolved oxygen concentrations can vary depending on both magnitude and duration of hypoxia/anoxia. As such, condition assessment could also consider how often concentrations fall below a thresholds and for how long. The assessments below speak to both of these needs.</p>
<p>First, the data are summarized from the continuous (~6 minute observations) to daily averages and summaries.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># 3 mg/l is acute, 4.8 mg/l is chronic</span>
<span class="va">dlysum</span> <span class="op">&lt;-</span> <span class="va">dodat</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
    Date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="va">DateTime</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Date</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/tidyverse.html">summarise</a></span><span class="op">(</span>
    acute <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html">any</a></span><span class="op">(</span><span class="va">do_mgl</span> <span class="op">&lt;</span> <span class="fl">3</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>, 
    chronic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html">any</a></span><span class="op">(</span><span class="va">do_mgl</span> <span class="op">&lt;</span> <span class="fl">4.8</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>, 
    do_mgl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">do_mgl</span><span class="op">)</span>, 
    .groups <span class="op">=</span> <span class="st">'drop'</span>
  <span class="op">)</span> 
<span class="va">dlysum</span>
<span class="co">#&gt; # A tibble: 2,857 x 4</span>
<span class="co">#&gt;    Date       acute chronic do_mgl</span>
<span class="co">#&gt;    &lt;date&gt;     &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt;  1 2013-01-01     0       0   11.0</span>
<span class="co">#&gt;  2 2013-01-02     0       0   11.3</span>
<span class="co">#&gt;  3 2013-01-03     0       0   11.6</span>
<span class="co">#&gt;  4 2013-01-04     0       0   11.8</span>
<span class="co">#&gt;  5 2013-01-05     0       0   11.7</span>
<span class="co">#&gt;  6 2013-01-06     0       0   11.9</span>
<span class="co">#&gt;  7 2013-01-07     0       0   12.1</span>
<span class="co">#&gt;  8 2013-01-08     0       0   12.2</span>
<span class="co">#&gt;  9 2013-01-09     0       0   12.2</span>
<span class="co">#&gt; 10 2013-01-10     0       0   11.9</span>
<span class="co">#&gt; # … with 2,847 more rows</span></code></pre></div>
<p>Indicator columns for acute and chronic indicate if DO concentrations were below the respective threshold at any point during each day. To address the duration of exposure to undersatured conditions, a cumulative tally of the number of days at which dissolved oxygen fell below is threshold is also calculated. These are present in the <code>acute_cumsum</code> and <code>acute_chronicsum</code> columns.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dlysum</span> <span class="op">&lt;-</span> <span class="va">dlysum</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span>grp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">acute</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span>, yr <span class="op">=</span> <span class="fu">year</span><span class="op">(</span><span class="va">Date</span><span class="op">)</span>, mo <span class="op">=</span> <span class="fu">month</span><span class="op">(</span><span class="va">Date</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
    acute_cumsum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">acute</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="va">ungroup</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span>grp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">chronic</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span>, <span class="va">yr</span>, <span class="va">mo</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
    chronic_cumsum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">chronic</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">grp</span><span class="op">)</span>
<span class="va">dlysum</span>
<span class="co">#&gt; # A tibble: 2,857 x 9</span>
<span class="co">#&gt; # Groups:   grp, yr, mo [1,661]</span>
<span class="co">#&gt;      grp Date       acute chronic do_mgl    yr    mo acute_cumsum chronic_cumsum</span>
<span class="co">#&gt;    &lt;int&gt; &lt;date&gt;     &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;          &lt;dbl&gt;</span>
<span class="co">#&gt;  1     1 2013-01-01     0       0   11.0  2013     1            0              0</span>
<span class="co">#&gt;  2     2 2013-01-02     0       0   11.3  2013     1            0              0</span>
<span class="co">#&gt;  3     3 2013-01-03     0       0   11.6  2013     1            0              0</span>
<span class="co">#&gt;  4     4 2013-01-04     0       0   11.8  2013     1            0              0</span>
<span class="co">#&gt;  5     5 2013-01-05     0       0   11.7  2013     1            0              0</span>
<span class="co">#&gt;  6     6 2013-01-06     0       0   11.9  2013     1            0              0</span>
<span class="co">#&gt;  7     7 2013-01-07     0       0   12.1  2013     1            0              0</span>
<span class="co">#&gt;  8     8 2013-01-08     0       0   12.2  2013     1            0              0</span>
<span class="co">#&gt;  9     9 2013-01-09     0       0   12.2  2013     1            0              0</span>
<span class="co">#&gt; 10    10 2013-01-10     0       0   11.9  2013     1            0              0</span>
<span class="co">#&gt; # … with 2,847 more rows</span></code></pre></div>
<p>The daily data provides the basis for summarizing seasonal information by month. Summarizing by month distills in the information into an easily digestible format for plotting.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mosum</span> <span class="op">&lt;-</span> <span class="va">dlysum</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span>
    yr <span class="op">=</span> <span class="fu">year</span><span class="op">(</span><span class="va">Date</span><span class="op">)</span>, 
    mo <span class="op">=</span> <span class="fu">month</span><span class="op">(</span><span class="va">Date</span>, label <span class="op">=</span> <span class="cn">T</span>, abbr <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/tidyverse.html">summarise</a></span><span class="op">(</span>
    do_mgl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">do_mgl</span><span class="op">)</span>, 
    acute <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">acute</span><span class="op">)</span>, 
    acute_cumsum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">acute_cumsum</span><span class="op">)</span>, 
    chronic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">chronic</span><span class="op">)</span>, 
    chronic_cumsum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">chronic_cumsum</span><span class="op">)</span>, 
    .groups <span class="op">=</span> <span class="st">'drop'</span>
  <span class="op">)</span>
<span class="va">mosum</span>
<span class="co">#&gt; # A tibble: 96 x 7</span>
<span class="co">#&gt;       yr mo    do_mgl acute acute_cumsum chronic chronic_cumsum</span>
<span class="co">#&gt;    &lt;dbl&gt; &lt;ord&gt;  &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;   &lt;dbl&gt;          &lt;dbl&gt;</span>
<span class="co">#&gt;  1  2013 Jan    11.7  0                0   0                  0</span>
<span class="co">#&gt;  2  2013 Feb    11.8  0                0   0                  0</span>
<span class="co">#&gt;  3  2013 Mar    11.3  0                0   0                  0</span>
<span class="co">#&gt;  4  2013 Apr     9.67 0                0   0                  0</span>
<span class="co">#&gt;  5  2013 May     8.13 0                0   0.161              1</span>
<span class="co">#&gt;  6  2013 Jun     6.59 0.3              5   0.767             13</span>
<span class="co">#&gt;  7  2013 Jul     4.94 0.935           29   0.968             30</span>
<span class="co">#&gt;  8  2013 Aug     5.32 0.806           14   0.871             15</span>
<span class="co">#&gt;  9  2013 Sep     6.02 0.667            6   0.933             17</span>
<span class="co">#&gt; 10  2013 Oct     7.29 0.290            8   0.516             12</span>
<span class="co">#&gt; # … with 86 more rows</span></code></pre></div>
<p>There are several ways the data were summarized:</p>
<ol style="list-style-type: decimal">
<li>
<code>acute</code>: The proportion of days in a month when concentrations in a given day fell below 3 mg/L</li>
<li>
<code>chronic</code>: The proportion of days in a month when concentrations in a given day fell below 4.8 mg/L</li>
<li>
<code>acute_cumsum</code>: The maximum number of sequential days in a month when concentrations in a given day fell below 3 mg/L</li>
<li>
<code>chronic_cumsum</code>: The average number of sequential days in a month when concentrations in a given day fell below 4.8 mg/L</li>
</ol>
<p>The first two item address only the number of times hypoxia conditions occurred, whereas the last two items address both the number of instances and duration of hypoxia.</p>
<p>The first two plot show the first two summaries.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ylims</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2013</span>, <span class="fl">2020</span><span class="op">)</span>
<span class="va">pthm</span> <span class="op">&lt;-</span> <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">theme</span><span class="op">(</span>
    axis.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>, 
    panel.grid.major <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>, 
    panel.grid.minor <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>, 
    legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>
  <span class="op">)</span>

<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">mosum</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">mo</span>, y <span class="op">=</span> <span class="va">yr</span>, fill <span class="op">=</span> <span class="va">acute</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_tile</span><span class="op">(</span>colour <span class="op">=</span> <span class="st">'black'</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">scale_x_discrete</span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">scale_y_continuous</span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="va">ylims</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">ylims</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">scale_fill_gradient2</span><span class="op">(</span>low <span class="op">=</span> <span class="st">'green'</span>, mid <span class="op">=</span> <span class="st">'yellow'</span>, high <span class="op">=</span> <span class="st">'red'</span>, midpoint <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="va">pthm</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>
    subtitle <span class="op">=</span> <span class="st">'(a) The proportion of days each month when concentrations in a given day fell below 3 mg/L'</span>
  <span class="op">)</span>
  
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">mosum</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">mo</span>, y <span class="op">=</span> <span class="va">yr</span>, fill <span class="op">=</span> <span class="va">chronic</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_tile</span><span class="op">(</span>colour <span class="op">=</span> <span class="st">'black'</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">scale_x_discrete</span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">scale_y_continuous</span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="va">ylims</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">ylims</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">scale_fill_gradient2</span><span class="op">(</span>low <span class="op">=</span> <span class="st">'green'</span>, mid <span class="op">=</span> <span class="st">'yellow'</span>, high <span class="op">=</span> <span class="st">'red'</span>, midpoint <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="va">pthm</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>
    subtitle <span class="op">=</span> <span class="st">'(b) The proportion of days each month when concentrations in a given day fell below 4.8 mg/L'</span>
  <span class="op">)</span>

<span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="fu">plot_layout</span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="dissolvedoxygen_files/figure-html/unnamed-chunk-8-1.png" width="768" style="display: block; margin: auto;"></p>
<p>The next two plots show the third and fourth summaries that address severity and duration of hypoxia.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">mosum</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">mo</span>, y <span class="op">=</span> <span class="va">yr</span>, fill <span class="op">=</span> <span class="va">acute_cumsum</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_tile</span><span class="op">(</span>colour <span class="op">=</span> <span class="st">'black'</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">scale_x_discrete</span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">scale_y_continuous</span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="va">ylims</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">ylims</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">scale_fill_gradient2</span><span class="op">(</span>low <span class="op">=</span> <span class="st">'green'</span>, mid <span class="op">=</span> <span class="st">'yellow'</span>, high <span class="op">=</span> <span class="st">'red'</span>, midpoint <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">+</span>
  <span class="va">pthm</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>
    subtitle <span class="op">=</span> <span class="st">'(a) The maximum number of sequential days in a month when concentrations in a given day fell below 3 mg/L'</span>
  <span class="op">)</span>
  
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">mosum</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">mo</span>, y <span class="op">=</span> <span class="va">yr</span>, fill <span class="op">=</span> <span class="va">chronic_cumsum</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_tile</span><span class="op">(</span>colour <span class="op">=</span> <span class="st">'black'</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">scale_x_discrete</span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">scale_y_continuous</span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="va">ylims</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">ylims</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">scale_fill_gradient2</span><span class="op">(</span>low <span class="op">=</span> <span class="st">'green'</span>, mid <span class="op">=</span> <span class="st">'yellow'</span>, high <span class="op">=</span> <span class="st">'red'</span>, midpoint <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">+</span>
  <span class="va">pthm</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>
    subtitle <span class="op">=</span> <span class="st">'(b) The maximum number of sequential days in a month when concentrations in a given day fell below 4.8 mg/L'</span>
  <span class="op">)</span>

<span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="fu">plot_layout</span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="dissolvedoxygen_files/figure-html/unnamed-chunk-9-1.png" width="768" style="display: block; margin: auto;"></p>
<p>Plotting the results provides insights into hypoxia patterns at the site depending on how under-saturated conditions were summarized.</p>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Marcus Beck.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
