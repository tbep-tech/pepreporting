<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dissolved Oxygen â€¢ pepreporting</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Dissolved Oxygen">
<meta property="og:description" content="pepreporting">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pepreporting</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Introduction.html">Introduction</a>
    </li>
    <li>
      <a href="../articles/dissolvedoxygen.html">Dissolved Oxygen</a>
    </li>
    <li>
      <a href="../articles/figures.html">Figures</a>
    </li>
    <li>
      <a href="../articles/pathogens.html">Beach Pathogens</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="dissolvedoxygen_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Dissolved Oxygen</h1>
            
      
      
      <div class="hidden name"><code>dissolvedoxygen.Rmd</code></div>

    </div>

    
    
<p>This vignette describes a proof of concept for summarizing and reporting dissolved oxygen (DO) data for the Peconic Estuary. Two continuous USGS monitoring stations collect DO data at locations in the Peconic Estuary: USGS stations 01304562 in the Peconic River and 01304200 in Orient Harbor. Data at these stations can be downloaded using the <code><a href="../reference/read_pepdo.html">read_pepdo()</a></code> function.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">exdat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_pepdo.html">read_pepdo</a></span><span class="op">(</span>site <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'01304562'</span>, <span class="st">'01304200'</span><span class="op">)</span>, nms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Peconic R.'</span>, <span class="st">'Orient Harbor'</span><span class="op">)</span>, startDate <span class="op">=</span> <span class="st">'2020-06-01'</span>, endDate <span class="op">=</span> <span class="st">'2020-06-30'</span><span class="op">)</span></code></pre></div>
<p>The <code>dodat</code> data object included with the package provides DO data from 2013 to 2020 at the two sites. This takes several minutes to download using the <code><a href="../reference/read_pepdo.html">read_pepdo()</a></code> function, so it is included with the package for ease of use.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dodat</span><span class="op">)</span>
<span class="co">#&gt;            site            DateTime do_mgl</span>
<span class="co">#&gt; 1 Orient Harbor 2013-01-01 00:00:00   11.2</span>
<span class="co">#&gt; 2 Orient Harbor 2013-01-01 00:06:00   11.2</span>
<span class="co">#&gt; 3 Orient Harbor 2013-01-01 00:12:00   11.2</span>
<span class="co">#&gt; 4 Orient Harbor 2013-01-01 00:18:00   11.2</span>
<span class="co">#&gt; 5 Orient Harbor 2013-01-01 00:24:00   11.2</span>
<span class="co">#&gt; 6 Orient Harbor 2013-01-01 00:30:00   11.2</span></code></pre></div>
<p>A plot of the raw data:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span><span class="va">dodat</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">DateTime</span>, y <span class="op">=</span> <span class="va">do_mgl</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">4.8</span>, linetype <span class="op">=</span> <span class="st">'dashed'</span>, colour <span class="op">=</span> <span class="st">'red'</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">3</span>, linetype <span class="op">=</span> <span class="st">'dashed'</span>, colour <span class="op">=</span> <span class="st">'red'</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">site</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">labs</span><span class="op">(</span>
    y <span class="op">=</span> <span class="st">'Dissolved oxygen (mg/L)'</span>, 
    x <span class="op">=</span> <span class="cn">NULL</span>, 
    title <span class="op">=</span> <span class="st">'Dissolved oxygen time series at Orient Harbor and Peconic River'</span>, 
    subtitle <span class="op">=</span> <span class="st">'Dashed lines are chronic and acute threhsolds (4.8, 3 mg/L)'</span>
  <span class="op">)</span></code></pre></div>
<p><img src="dissolvedoxygen_files/figure-html/unnamed-chunk-4-1.png" width="768" style="display: block; margin: auto;"></p>
<p>Dissolved oxygen data typically show daily and seasonal variation. Summaries of condition should account for variation at both temporal scales. Further, the impact of low dissolved oxygen concentrations on biota can vary depending on both magnitude and duration of hypoxia/anoxia. As such, condition assessment could also consider how often concentrations fall below a thresholds and for how long. The assessments below speak to each of these needs.</p>
<p>First, the data can be summarized from the continuous (~6 minute observations) to daily averages using the <code>anlz_dodlpep()</code> function. A user-specified threshold can be supplied to the <code>thr</code> argument to summarize the data relative to a value of interest, the default value being the acute threshold of 3 mg/L (an alternative may be the chronic threshold of 4.8 mg/L, <span class="citation">[1]</span>).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># 3 mg/l is acute, 4.8 mg/l is chronic</span>
<span class="va">dlysum</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/anlz_dodlypep.html">anlz_dodlypep</a></span><span class="op">(</span><span class="va">dodat</span>, thr <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="va">dlysum</span>
<span class="co">#&gt; # A tibble: 5,338 x 7</span>
<span class="co">#&gt;    site          Date          yr    mo do_mgl below below_cumsum</span>
<span class="co">#&gt;    &lt;fct&gt;         &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;</span>
<span class="co">#&gt;  1 Peconic River 2013-01-01  2013     1   11.0     0            0</span>
<span class="co">#&gt;  2 Peconic River 2013-01-02  2013     1   11.3     0            0</span>
<span class="co">#&gt;  3 Peconic River 2013-01-03  2013     1   11.6     0            0</span>
<span class="co">#&gt;  4 Peconic River 2013-01-04  2013     1   11.6     0            0</span>
<span class="co">#&gt;  5 Peconic River 2013-01-05  2013     1   11.7     0            0</span>
<span class="co">#&gt;  6 Peconic River 2013-01-06  2013     1   11.8     0            0</span>
<span class="co">#&gt;  7 Peconic River 2013-01-07  2013     1   12.0     0            0</span>
<span class="co">#&gt;  8 Peconic River 2013-01-08  2013     1   12.1     0            0</span>
<span class="co">#&gt;  9 Peconic River 2013-01-09  2013     1   12.0     0            0</span>
<span class="co">#&gt; 10 Peconic River 2013-01-10  2013     1   11.7     0            0</span>
<span class="co">#&gt; # â€¦ with 5,328 more rows</span></code></pre></div>
<p>The last three columns show the daily summarized data. The <code>do_mgl</code> column shows the average DO concentration for each day, the <code>below</code> column shows a 1 (yes) or 0 (no) if the concentration was below the threshold value at any point during a day, and the <code>below_cumsum</code> column shows a cumulative tally of the number of days in each month at which dissolved oxygen fell below the threshold at any point during a day.</p>
<p>The data can also be summarized by month using the <code><a href="../reference/anlz_domopep.html">anlz_domopep()</a></code> function. Summarizing by month distills the information into a simple format for plotting. Internally, the <code><a href="../reference/anlz_domopep.html">anlz_domopep()</a></code> function uses the <code><a href="../reference/anlz_dodlypep.html">anlz_dodlypep()</a></code> function to first summarize results by day, which are then summarized by month.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mosum</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/anlz_domopep.html">anlz_domopep</a></span><span class="op">(</span><span class="va">dodat</span>, thr <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="va">mosum</span>
<span class="co">#&gt; # A tibble: 189 x 6</span>
<span class="co">#&gt;    site             yr mo    do_mgl below_ave below_maxrun</span>
<span class="co">#&gt;  * &lt;fct&gt;         &lt;dbl&gt; &lt;ord&gt;  &lt;dbl&gt;     &lt;dbl&gt;        &lt;dbl&gt;</span>
<span class="co">#&gt;  1 Peconic River  2013 Jan    11.6      0                0</span>
<span class="co">#&gt;  2 Peconic River  2013 Feb    11.9      0                0</span>
<span class="co">#&gt;  3 Peconic River  2013 Mar    11.7      0                0</span>
<span class="co">#&gt;  4 Peconic River  2013 Apr     9.55     0                0</span>
<span class="co">#&gt;  5 Peconic River  2013 May     7.90     0                0</span>
<span class="co">#&gt;  6 Peconic River  2013 Jun     5.73     0.3              5</span>
<span class="co">#&gt;  7 Peconic River  2013 Jul     3.12     1               27</span>
<span class="co">#&gt;  8 Peconic River  2013 Aug     3.13     1               24</span>
<span class="co">#&gt;  9 Peconic River  2013 Sep     4.81     0.655            6</span>
<span class="co">#&gt; 10 Peconic River  2013 Oct     6.03     0.348            7</span>
<span class="co">#&gt; # â€¦ with 179 more rows</span></code></pre></div>
<p>The last three columns show the monthly summarized data, where <code>do_mgl</code> is the average of all daily DO averages across the month, <code>below_ave</code> is the proportion of days in a month when concentrations in a given day fell below the threshold (1 would mean all days had an instance of DO below the threshold, 0 would mean none), and <code>below_maxrun()</code> is the maximum number of sequential days in a month when concentrations in a given day fell below the threshold (30 or 31, depending on month, would indicate all days in a month had an instance of DO below the threshold).</p>
<p>The <code>below_ave</code> and <code>below_maxrun</code> columns summarize the DO data differently depending on how hypoxia/anoxia conditions can be described relative to potential impacts on biological resources. The <code>below_ave</code> column summarizes undersaturation relative to only the number of times hypoxia conditions occurred, whereas the <code>below_maxrun</code> column summarizes undersaturation relative to both the number of instances and duration of hypoxia. In other words, biota may be stressed differently depending on the number of times hypoxia occurs vs how long it may persist. The two measures may indicate similar information, but not always depending on characteristics of the DO time series.</p>
<p>The summarized monthly data can be plotted with the <code><a href="../reference/show_domatrix.html">show_domatrix()</a></code> function. In this example, the default plot shows the proportion of days in a month when concentrations in a given day fell below a threshold of 3 mg/L.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/show_domatrix.html">show_domatrix</a></span><span class="op">(</span><span class="va">dodat</span>, thr <span class="op">=</span> <span class="fl">3</span>, show <span class="op">=</span> <span class="st">'below_ave'</span><span class="op">)</span></code></pre></div>
<p><img src="dissolvedoxygen_files/figure-html/unnamed-chunk-7-1.png" width="768" style="display: block; margin: auto;"></p>
<p>The maximum number of sequential days in a month when concentrations in a given day fell below the threshold can also be plotted by changing the <code>show</code> argument.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/show_domatrix.html">show_domatrix</a></span><span class="op">(</span><span class="va">dodat</span>, thr <span class="op">=</span> <span class="fl">3</span>, show <span class="op">=</span> <span class="st">'below_maxrun'</span><span class="op">)</span></code></pre></div>
<p><img src="dissolvedoxygen_files/figure-html/unnamed-chunk-8-1.png" width="768" style="display: block; margin: auto;"></p>
<p>The threshold can also be changed. For example, the chronic threshold of 4.8 mg/L shows conditions relative to a more conservative threshold.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/show_domatrix.html">show_domatrix</a></span><span class="op">(</span><span class="va">dodat</span>, thr <span class="op">=</span> <span class="fl">4.8</span>, show <span class="op">=</span> <span class="st">'below_ave'</span><span class="op">)</span></code></pre></div>
<p><img src="dissolvedoxygen_files/figure-html/unnamed-chunk-9-1.png" width="768" style="display: block; margin: auto;"></p>
<p>Plotting the results provides insights into hypoxia patterns at the site depending on how under-saturated conditions were summarized. Additional considerations may include:</p>
<ol style="list-style-type: decimal">
<li>Relevance of a threshold to biological indicator</li>
<li>Spatial extent of the indicators</li>
<li>Breakpoints for management decisions</li>
</ol>
<div id="refs" class="references">
<div id="ref-USEPA00">
<p>[1] USEPA, Ambient aquatic life water quality criteria for dissolved oxygen (saltwater): Cape cod to cape hatteras, Office of Water, Office of Research; Development, US Environmental Protection Agency, Washington, DC, 2000.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Marcus Beck.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
